import{a as it}from"./chunk-MYBN2S3T.js";import{a as U}from"./chunk-644IHEFN.js";import{a as j,b as K,c as G,d as W,e as X,f as q,g as J,h as Q,i as Y,j as Z,k as tt,l as et,m as at,n as nt,o as rt,p as ot,q as lt,r as mt,s as st,t as pt,u as ct,v as dt}from"./chunk-HRIUTT6J.js";import{b as B}from"./chunk-ZLIFJTJT.js";import"./chunk-NXHIHCJN.js";import{B as R,C as P,y}from"./chunk-CSSOTJKK.js";import{a as V,b as A,e as F}from"./chunk-FF3Q3FET.js";import{w as N,x as O,z}from"./chunk-JNOJBTV6.js";import{G as H,H as $}from"./chunk-MDJVDLUZ.js";import{d as T,h as k,p as L}from"./chunk-VYZYS6JX.js";import{Ac as w,Eb as c,Fb as n,Gb as i,Hb as S,Lb as h,Mb as C,Ob as v,Vb as f,Wb as x,Ya as p,ec as D,gb as E,ic as o,kc as M,ma as d,na as u,nb as I,rc as b,sb as _,xa as g}from"./chunk-CUARONR7.js";import"./chunk-FDERIQAA.js";var ft=()=>[10,25,50];function gt(e,t){if(e&1&&(n(0,"mat-option",30),o(1),i()),e&2){let a=t.$implicit;c("value",a.id),p(),M(" ",a.nome," ")}}function _t(e,t){e&1&&(n(0,"th",31),o(1,"Armadilha"),i())}function ht(e,t){if(e&1&&(n(0,"td",32),o(1),i()),e&2){let a,r=t.$implicit,l=x();p(),M(" ",(a=l.getArmadilha(r.armadilhaId))==null?null:a.nome," ")}}function Ct(e,t){e&1&&(n(0,"th",33),o(1,"Data"),i())}function Mt(e,t){if(e&1&&(n(0,"td",32),o(1),i()),e&2){let a=t.$implicit;p(),M(" ",a.data," ")}}function xt(e,t){e&1&&(n(0,"th",31),o(1,"Status"),i())}function St(e,t){if(e&1&&(n(0,"td",32)(1,"mat-chip",34),o(2),i()()),e&2){let a=t.$implicit,r=x();p(),c("color",r.statusColor(a.status)),p(),M(" ",a.status," ")}}function wt(e,t){e&1&&(n(0,"th",31),o(1,"Situa\xE7\xE3o"),i())}function vt(e,t){if(e&1&&(n(0,"td",32)(1,"mat-chip",34),o(2),i()()),e&2){let a=t.$implicit,r=x();p(),c("color",r.situacaoColor(a.situacaoFisica)),p(),M(" ",a.situacaoFisica," ")}}function Dt(e,t){e&1&&(n(0,"th",33),o(1,"Total"),i())}function Et(e,t){if(e&1&&(n(0,"td",35),o(1),i()),e&2){let a=t.$implicit;p(),M(" ",a.numTotal," ")}}function It(e,t){e&1&&S(0,"th",31)}function bt(e,t){if(e&1){let a=v();n(0,"td",36)(1,"button",37),f("click",function(l){let m=d(a).$implicit,s=x();return u(s.open(m,l))}),n(2,"mat-icon"),o(3,"open_in_new"),i()()()}}function Tt(e,t){e&1&&S(0,"tr",38)}function kt(e,t){if(e&1){let a=v();n(0,"tr",39),f("click",function(){let l=d(a).$implicit,m=x();return u(m.open(l))}),i()}}var ut=class e{constructor(t){this.router=t}cols=["armadilha","data","status","situacao","total","acoes"];capturas=g(U);armadilhas=g(B);getArmadilha(t){return this.armadilhaMap().get(t)}open(t,a){a?.stopPropagation(),this.router.navigate(["/workspace/entities/capturas",t.id])}goBack(){this.router.navigate(["/workspace"])}statusColor(t){return t==="ATIVA"?"primary":"warn"}situacaoColor(t){switch(t){case"REGULAR":return"primary";case"DERRUBADA":return"accent";case"EXTRAVIADA":return"warn"}}armadilhaMap=w(()=>new Map(this.armadilhas().map(t=>[t.id,t])));search=g("");armadilhaId=g(null);dataInicio=g(null);dataFim=g(null);sort=g({active:"data",direction:"desc"});pageIndex=g(0);pageSize=g(10);filtered=w(()=>this.capturas().filter(t=>{if(this.search()&&!`${this.getArmadilha(t.armadilhaId)?.nome} ${t.status} ${t.situacaoFisica}`.toLowerCase().includes(this.search())||this.armadilhaId()&&t.armadilhaId!==this.armadilhaId())return!1;let a=new Date(t.data+"T00:00:00");return!(this.dataInicio()&&a<this.dataInicio()||this.dataFim()&&a>this.dataFim())}));sorted=w(()=>{let{active:t,direction:a}=this.sort();return a?[...this.filtered()].sort((r,l)=>{let m,s;switch(t){case"data":m=new Date(r.data).getTime(),s=new Date(l.data).getTime();break;case"total":m=r.numTotal,s=l.numTotal;break;default:return 0}return a==="asc"?m-s:s-m}):this.filtered()});pagedData=w(()=>{let t=this.pageIndex()*this.pageSize();return this.sorted().slice(t,t+this.pageSize())});onSearch(t){this.search.set(t.target.value.toLowerCase()),this.pageIndex.set(0)}onArmadilha(t){this.armadilhaId.set(t||null),this.pageIndex.set(0)}onInicio(t){this.dataInicio.set(t),this.pageIndex.set(0)}onFim(t){this.dataFim.set(t),this.pageIndex.set(0)}onSort(t){this.sort.set(t)}onPage(t){this.pageIndex.set(t.pageIndex),this.pageSize.set(t.pageSize)}create(){this.router.navigate(["/workspace/entities/capturas/new"])}static \u0275fac=function(a){return new(a||e)(E(L))};static \u0275cmp=I({type:e,selectors:[["app-capturas-list"]],decls:61,vars:13,consts:[["ini",""],["fim",""],[1,"page"],["mat-button","",1,"back-btn",3,"click"],[1,"page-header"],[1,"header-left"],["mat-flat-button","","color","primary",3,"click"],[1,"filters"],["appearance","outline"],["matInput","",3,"input"],[3,"selectionChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["matInput","",3,"dateChange","matDatepicker"],["matSuffix","",3,"for"],["mat-table","","matSort","",3,"matSortChange","dataSource"],["matColumnDef","armadilha"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","data"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","status"],["matColumnDef","situacao"],["matColumnDef","total"],["mat-cell","","class","center",4,"matCellDef"],["matColumnDef","acoes"],["mat-cell","","class","actions-cell",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],[3,"page","length","pageSize","pageIndex","pageSizeOptions"],[3,"value"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","","mat-sort-header",""],["selected","",3,"color"],["mat-cell","",1,"center"],["mat-cell","",1,"actions-cell"],["mat-icon-button","",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(a,r){if(a&1){let l=v();n(0,"div",2)(1,"button",3),f("click",function(){return d(l),u(r.goBack())}),n(2,"mat-icon"),o(3,"arrow_back"),i(),o(4," Workspace "),i(),n(5,"div",4)(6,"div",5)(7,"h1"),o(8,"Capturas"),i()(),n(9,"button",6),f("click",function(){return d(l),u(r.create())}),n(10,"mat-icon"),o(11,"add"),i(),o(12," Nova captura "),i()(),n(13,"div",7)(14,"mat-form-field",8)(15,"mat-label"),o(16,"Buscar"),i(),n(17,"input",9),f("input",function(s){return d(l),u(r.onSearch(s))}),i()(),n(18,"mat-form-field",8)(19,"mat-label"),o(20,"Armadilha"),i(),n(21,"mat-select",10),f("selectionChange",function(s){return d(l),u(r.onArmadilha(s.value))}),n(22,"mat-option",11),o(23,"Todas"),i(),_(24,gt,2,2,"mat-option",12),i()(),n(25,"mat-form-field",8)(26,"mat-label"),o(27,"Data inicial"),i(),n(28,"input",13),f("dateChange",function(s){return d(l),u(r.onInicio(s.value))}),i(),S(29,"mat-datepicker-toggle",14)(30,"mat-datepicker",null,0),i(),n(32,"mat-form-field",8)(33,"mat-label"),o(34,"Data final"),i(),n(35,"input",13),f("dateChange",function(s){return d(l),u(r.onFim(s.value))}),i(),S(36,"mat-datepicker-toggle",14)(37,"mat-datepicker",null,1),i()(),n(39,"table",15),f("matSortChange",function(s){return d(l),u(r.onSort(s))}),h(40,16),_(41,_t,2,0,"th",17)(42,ht,2,1,"td",18),C(),h(43,19),_(44,Ct,2,0,"th",20)(45,Mt,2,1,"td",18),C(),h(46,21),_(47,xt,2,0,"th",17)(48,St,3,2,"td",18),C(),h(49,22),_(50,wt,2,0,"th",17)(51,vt,3,2,"td",18),C(),h(52,23),_(53,Dt,2,0,"th",20)(54,Et,2,1,"td",24),C(),h(55,25),_(56,It,1,0,"th",17)(57,bt,4,0,"td",26),C(),_(58,Tt,1,0,"tr",27)(59,kt,1,0,"tr",28),i(),n(60,"mat-paginator",29),f("page",function(s){return d(l),u(r.onPage(s))}),i()()}if(a&2){let l=D(31),m=D(38);p(24),c("ngForOf",r.armadilhas()),p(4),c("matDatepicker",l),p(),c("for",l),p(6),c("matDatepicker",m),p(),c("for",m),p(3),c("dataSource",r.pagedData()),p(19),c("matHeaderRowDef",r.cols),p(),c("matRowDefColumns",r.cols),p(),c("length",r.filtered().length)("pageSize",r.pageSize())("pageIndex",r.pageIndex())("pageSizeOptions",b(12,ft))}},dependencies:[k,T,at,G,X,Y,q,W,Z,J,Q,tt,et,K,j,F,V,A,z,O,N,$,H,it,rt,nt,P,R,y,dt,st,pt,ct,mt,ot,lt],styles:[".page[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin-right:auto;margin-left:auto}.page-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:16px;margin-bottom:16px}.back-btn[_ngcontent-%COMP%]{min-width:auto;padding:0 8px;color:#555}.search[_ngcontent-%COMP%]{width:320px;margin-bottom:12px}table[_ngcontent-%COMP%]{width:100%;table-layout:fixed}td.mat-cell[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.center[_ngcontent-%COMP%]{text-align:center}.filters[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px;margin-bottom:16px}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}"]})};export{ut as CapturasList};
