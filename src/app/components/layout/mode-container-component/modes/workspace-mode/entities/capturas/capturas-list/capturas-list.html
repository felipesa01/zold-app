<div class="page">

  <div class="page-header">
    <button mat-button class="back-btn" (click)="goBack()">
      <mat-icon>arrow_back</mat-icon>
      Workspace
    </button>
    <h1>Capturas</h1>
  </div>

  <div class="filters">

    <!-- Busca texto -->
    <mat-form-field appearance="outline">
      <mat-label>Buscar</mat-label>
      <input matInput (input)="onSearch($event)" />
    </mat-form-field>

    <!-- Armadilha -->
    <mat-form-field appearance="outline">
      <mat-label>Armadilha</mat-label>
      <mat-select (selectionChange)="onArmadilha($event.value)">
        <mat-option value="">Todas</mat-option>
        <mat-option *ngFor="let a of armadilhas()" [value]="a.id">
          {{ a.nome }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <!-- Data início -->
    <mat-form-field appearance="outline">
      <mat-label>Data inicial</mat-label>
      <input matInput [matDatepicker]="ini" (dateChange)="onInicio($event.value)" />
      <mat-datepicker-toggle matSuffix [for]="ini"></mat-datepicker-toggle>
      <mat-datepicker #ini></mat-datepicker>
    </mat-form-field>

    <!-- Data fim -->
    <mat-form-field appearance="outline">
      <mat-label>Data final</mat-label>
      <input matInput [matDatepicker]="fim" (dateChange)="onFim($event.value)" />
      <mat-datepicker-toggle matSuffix [for]="fim"></mat-datepicker-toggle>
      <mat-datepicker #fim></mat-datepicker>
    </mat-form-field>

  </div>


  <table mat-table [dataSource]="pagedData()" matSort (matSortChange)="onSort($event)">

    <!-- Armadilha -->
    <ng-container matColumnDef="armadilha">
      <th mat-header-cell *matHeaderCellDef>Armadilha</th>
      <td mat-cell *matCellDef="let c">
        {{ getArmadilha(c.armadilhaId)?.nome }}
      </td>
    </ng-container>

    <!-- Data -->
    <ng-container matColumnDef="data">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Data</th>
      <td mat-cell *matCellDef="let c">
        {{ c.data }}
      </td>
    </ng-container>

    <!-- Status -->
    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef>Status</th>
      <td mat-cell *matCellDef="let c">
        <mat-chip [color]="statusColor(c.status)" selected>
          {{ c.status }}
        </mat-chip>
      </td>
    </ng-container>

    <!-- Situação -->
    <ng-container matColumnDef="situacao">
      <th mat-header-cell *matHeaderCellDef>Situação</th>
      <td mat-cell *matCellDef="let c">
        <mat-chip [color]="situacaoColor(c.situacaoFisica)" selected>
          {{ c.situacaoFisica }}
        </mat-chip>
      </td>
    </ng-container>

    <!-- Total -->
    <ng-container matColumnDef="total">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Total</th>
      <td mat-cell *matCellDef="let c" class="center">
        {{ c.numTotal }}
      </td>
    </ng-container>

    <!-- Ações -->
    <ng-container matColumnDef="acoes">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let c" class="actions-cell">
        <button mat-icon-button (click)="open(c, $event)">
          <mat-icon>open_in_new</mat-icon>
        </button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="cols"></tr>
    <tr mat-row *matRowDef="let row; columns: cols" (click)="open(row)">
    </tr>

  </table>

  <mat-paginator [length]="filtered().length" [pageSize]="pageSize()" [pageIndex]="pageIndex()"
    [pageSizeOptions]="[10, 25, 50]" (page)="onPage($event)">
  </mat-paginator>

</div>